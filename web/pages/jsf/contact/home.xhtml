<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:head><title>Home</title></h:head>
<h:body>
    <f:view>
        <h:form rendered="#{not empty contactManager.contacts}">
            <h:dataTable value="#{contactManager.model}" var="item">
                <h:column><f:facet name="header">Last name</f:facet>#{item.lastName}</h:column>
                <h:column><f:facet name="header">First name</f:facet>#{item.firstName}</h:column>
                <h:column><f:facet name="header">Email</f:facet>#{item.email}</h:column>
                <h:column><h:commandButton value="edit" action="#{contactManager.edit}"/></h:column>
                <h:column><h:commandButton value="delete" action="#{contactManager.delete}"/></h:column>
            </h:dataTable>
        </h:form>
        <h:panelGroup rendered="#{empty contactManager.contacts}">
            <p>Table is empty! Please add new items.</p>
        </h:panelGroup>
        <h:panelGroup rendered="#{!contactManager.edit}">
            <h3>Add item</h3>
            <h:form id="form">

                <!--CONTACT-->

                <h:panelGrid columns="3">
                    <h:outputLabel for="firstName" value="First name : "/>
                    <h:inputText id="firstName" value="#{contactManager.item.firstName}"
                                 required="#{param['form:add'] != null}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="firstName" autoUpdate="true"/>

                    <h:outputLabel for="lastName" value="Last name : "/>
                    <h:inputText id="lastName" value="#{contactManager.item.lastName}"
                                 required="#{param['form:add'] != null}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="lastName" autoUpdate="true"/>

                    <h:outputLabel for="email" value="Email : "/>
                    <h:inputText id="email" value="#{contactManager.item.email}" required="#{param['form:add'] != null}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="email" autoUpdate="true"/>
                </h:panelGrid>

                <!--ADDRESS-->

                <h:panelGrid columns="3">
                    <h:outputLabel for="street" value="Street : "/>
                    <h:inputText id="street" value="#{contactManager.item.address.street}"
                                 required="#{not empty param['form:city'] or not empty param['form:zip']
                             or not empty param['form:country']}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="street" autoUpdate="true"/>

                    <h:outputLabel for="city" value="City : "/>
                    <h:inputText id="city" value="#{contactManager.item.address.city}"
                                 required="#{not empty param['form:street'] or not empty param['form:zip']
                             or not empty param['form:country']}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="city" autoUpdate="true"/>

                    <h:outputLabel for="zip" value="Zip : "/>
                    <h:inputText id="zip" value="#{contactManager.item.address.zip}"
                                 required="#{not empty param['form:city'] or not empty param['form:street']
                             or not empty param['form:country']}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="zip" autoUpdate="true"/>

                    <h:outputLabel for="country" value="Country : "/>
                    <h:inputText id="country" value="#{contactManager.item.address.country}"
                                 required="#{not empty param['form:city'] or not empty param['form:zip']
                             or not empty param['form:street']}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="country" autoUpdate="true"/>
                </h:panelGrid>

                <!--PHONES-->

                <h:dataTable id="phones" value="#{contactManager.item.phones}" var="phone">
                    <h:column>
                        <h:outputLabel for="phoneNumber" value="Phone number"/>
                    </h:column>
                    <h:column>
                        <h:inputText id="phoneNumber" value="#{phone.phoneNumber}"
                                     required="true"
                                     requiredMessage="Required !">
                        </h:inputText>
                    </h:column>
                    <h:column>
                        <h:message for="phoneNumber" autoUpdate="true"/>
                    </h:column>
                    <h:column>
                        <h:outputLabel for="phoneKind" value="Phone kind"/>
                    </h:column>
                    <h:column>
                        <h:inputText id="phoneKind" value="#{phone.phoneKind}"
                                     required="true"
                                     requiredMessage="Required !">
                        </h:inputText>
                    </h:column>
                    <h:column>
                        <h:message for="phoneKind" autoUpdate="true"/>
                    </h:column>
                    <h:column>
                        <h:commandButton id="remove" value="remove" action="#{contactManager.remove(phone)}"
                                         immediate="true"/>
                    </h:column>
                </h:dataTable>
                <h:commandButton id="addPhone" value="add phone" action="#{contactManager.addPhone}"/>

                <p><h:commandButton id="add" value="create" action="#{contactManager.add}"/></p>
            </h:form>
        </h:panelGroup>

        <h:panelGroup rendered="#{contactManager.edit}">
            <h3>Edit item #{contactManager.item.id}</h3>
            <h:form id="formEdit">

                <!--CONTACT-->

                <h:panelGrid columns="3">
                    <h:outputLabel for="firstNameEdit" value="First name : "/>
                    <h:inputText id="firstNameEdit" value="#{contactManager.item.firstName}"
                                 required="#{param['formEdit:saveEdit'] != null}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="firstNameEdit" autoUpdate="true"/>

                    <h:outputLabel for="lastNameEdit" value="Last name : "/>
                    <h:inputText id="lastNameEdit" value="#{contactManager.item.lastName}"
                                 required="#{param['formEdit:saveEdit'] != null}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="lastNameEdit" autoUpdate="true"/>

                    <h:outputLabel for="emailEdit" value="Email : "/>
                    <h:inputText id="emailEdit" value="#{contactManager.item.email}"
                                 required="#{param['formEdit:saveEdit'] != null}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="emailEdit" autoUpdate="true"/>
                </h:panelGrid>

                <!--ADDRESS-->

                <h:panelGrid columns="3">
                    <h:outputLabel for="streetEdit" value="Street : "/>
                    <h:inputText id="streetEdit" value="#{contactManager.item.address.street}"
                                 required="#{not empty param['formEdit:cityEdit'] or not empty param['formEdit:zipEdit']
                             or not empty param['formEdit:country']}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="streetEdit" autoUpdate="true"/>

                    <h:outputLabel for="cityEdit" value="City : "/>
                    <h:inputText id="cityEdit" value="#{contactManager.item.address.city}"
                                 required="#{not empty param['formEdit:streetEdit'] or not empty param['formEdit:zipEdit']
                             or not empty param['formEdit:countryEdit']}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="cityEdit" autoUpdate="true"/>

                    <h:outputLabel for="zipEdit" value="Zip : "/>
                    <h:inputText id="zipEdit" value="#{contactManager.item.address.zip}"
                                 required="#{not empty param['formEdit:cityEdit'] or not empty param['formEdit:streetEdit']
                             or not empty param['formEdit:countryEdit']}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="zipEdit" autoUpdate="true"/>

                    <h:outputLabel for="countryEdit" value="Country : "/>
                    <h:inputText id="countryEdit" value="#{contactManager.item.address.country}"
                                 required="#{not empty param['formEdit:cityEdit'] or not empty param['formEdit:zipEdit']
                             or not empty param['formEdit:streetEdit']}"
                                 requiredMessage="Required !"
                                 validator="noBlankSpaceValidator">
                    </h:inputText>
                    <h:message for="countryEdit" autoUpdate="true"/>
                </h:panelGrid>

                <!--PHONES-->

                <h:dataTable id="phonesEdit" value="#{contactManager.item.phones}" var="phone">
                    <h:column>
                        <h:outputLabel for="phoneNumberEdit" value="Phone number"/>
                    </h:column>
                    <h:column>
                        <h:inputText id="phoneNumberEdit" value="#{phone.phoneNumber}"
                                     required="true"
                                     requiredMessage="Required !">
                        </h:inputText>
                    </h:column>
                    <h:column>
                        <h:message for="phoneNumberEdit" autoUpdate="true"/>
                    </h:column>
                    <h:column>
                        <h:outputLabel for="phoneKindEdit" value="Phone kind"/>
                    </h:column>
                    <h:column>
                        <h:inputText id="phoneKindEdit" value="#{phone.phoneKind}"
                                     required="true"
                                     requiredMessage="Required !">
                        </h:inputText>
                    </h:column>
                    <h:column>
                        <h:message for="phoneKindEdit" autoUpdate="true"/>
                    </h:column>
                    <h:column>
                        <h:commandButton id="removeEdit" value="remove" action="#{contactManager.remove(phone)}"
                                         immediate="true"/>
                    </h:column>
                </h:dataTable>
                <h:commandButton id="addPhoneEdit" value="add phone" action="#{contactManager.addPhone}"/>

                <p><h:commandButton id="saveEdit" value="save" action="#{contactManager.save}"/></p>
                <p><h:commandButton id="cancel" value="cancel" action="#{contactManager.cancel}"/></p>
            </h:form>
        </h:panelGroup>
    </f:view>
</h:body>
</html>
